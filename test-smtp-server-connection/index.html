<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Test SMTP Server Connection - PDS IT Solutions</title><meta name="description" content="Sometimes you need to test to see if your SMTP server is even listening to you, especially if it requires authentication! Use either this python script, or these PowerShell commands to find out! First, set some credentials $credz = get-credential Then send the message Send-MailMessage&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script defer="defer" type="text/javascript" data-domain="pds-it-solutions.com" src="https://plausible.io/js/plausible.js"></script><script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script><link rel="canonical" href="https://www.pds-it-solutions.com/test-smtp-server-connection/"><link rel="alternate" type="application/atom+xml" href="https://www.pds-it-solutions.com/feed.xml"><link rel="alternate" type="application/json" href="https://www.pds-it-solutions.com/feed.json"><meta property="og:title" content="Test SMTP Server Connection"><meta property="og:image" content="https://www.pds-it-solutions.com/media/website/Color-logo-no-background.png"><meta property="og:image:width" content="3163"><meta property="og:image:height" content="1142"><meta property="og:site_name" content="PDS IT Solutions"><meta property="og:description" content="Sometimes you need to test to see if your SMTP server is even listening to you, especially if it requires authentication! Use either this python script, or these PowerShell commands to find out! First, set some credentials $credz = get-credential Then send the message Send-MailMessage&hellip;"><meta property="og:url" content="https://www.pds-it-solutions.com/test-smtp-server-connection/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://www.pds-it-solutions.com/assets/css/style.css?v=a90ccfb4be7b0723bfa1a54a7e5b3d7a"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.pds-it-solutions.com/test-smtp-server-connection/"},"headline":"Test SMTP Server Connection","datePublished":"2024-06-11T17:57-06:00","dateModified":"2024-12-16T09:36-07:00","image":{"@type":"ImageObject","url":"https://www.pds-it-solutions.com/media/website/Color-logo-no-background.png","height":1142,"width":3163},"description":"Sometimes you need to test to see if your SMTP server is even listening to you, especially if it requires authentication! Use either this python script, or these PowerShell commands to find out! First, set some credentials $credz = get-credential Then send the message Send-MailMessage&hellip;","author":{"@type":"Person","name":"p Bryson","url":"https://www.pds-it-solutions.com/authors/p-bryson/"},"publisher":{"@type":"Organization","name":"p Bryson","logo":{"@type":"ImageObject","url":"https://www.pds-it-solutions.com/media/website/Color-logo-no-background.png","height":1142,"width":3163}}}</script><style></style><noscript><style>img[loading]{opacity:1;}</style></noscript></head><body class="page-template"><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://www.pds-it-solutions.com/"><img src="https://www.pds-it-solutions.com/media/website/Color-logo-no-background.png" alt="PDS IT Solutions" width="3163" height="1142"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li class="active-parent has-submenu"><a href="https://www.pds-it-solutions.com/" target="_self" aria-haspopup="true">SysAdmin Library</a><ul class="navbar__submenu level-2" aria-hidden="true"><li class="active"><a href="https://www.pds-it-solutions.com/test-smtp-server-connection/" target="_self">Test SMTP Connections</a></li><li><a href="https://www.pds-it-solutions.com/connect-to-exchange-online-and-do-stuff/" target="_self">Exchange Online w/Powershell</a></li><li><a href="https://www.pds-it-solutions.com/connect-to-teams-admin-and-do-stuff/" target="_self">MS Teams Admin w/Powershell</a></li></ul></li></ul></nav></div></header><div class="main-content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2024-12-16T16:06">December 16, 2024</time></div></div><main class="main page"><article class="content"><header class="u-header content__header"><h1>Test SMTP Server Connection</h1></header><div class="content__entry u-inner"><p>Sometimes you need to test to see if your SMTP server is even listening to you, especially if it requires authentication!  Use either this python script, or these PowerShell commands to find out!</p><h2>PowerShell Method</h2><p><strong>First, set some credentials</strong><br><code>$credz = get-credential</code></p><p><strong>Then send the message</strong><br><code>Send-MailMessage -From from@addr.com -To email@addr.com -Subject "Test" -Body "Testing Email via PowerShell" -SmtpServer smtp.office365.com -Credential $credz -UseSSL -Port 587</code></p><h2>Python Method</h2><p>I tend to run the python code in a Jupyter Lab session, but you can run it however works best for you.  </p><p><code>import smtplib, ssl</code><br><code>from email.mime.text import MIMEText</code></p><p><code>smtp_server = "smtp.office365.com"</code><br><code>port = 587 # For starttls</code><br><code>sender_email = "email-at-domain-dot-com"</code><br><code>password = "hellalongpassword"</code><br><code>msg = MIMEText("Test")</code><br><code># Create a secure SSL context</code><br><code>context = ssl.create_default_context()</code></p><p><code># Try to log in to server and send email</code><br><code>try:</code><br><code>server = smtplib.SMTP(smtp_server,port)</code><br><code>server.ehlo() # Can be omitted</code><br><code>server.starttls(context=context) # Secure the connection</code><br><code>server.ehlo() # Can be omitted</code><br><code>server.login(sender_email, password)</code><br><code># Send email here</code><br><code>me = "from@domain.com"</code><br><code>you = "targetRecipient@domain.com"</code></p><p><code># me == the sender's email address</code><br><code># you == the recipient's email address</code><br><code>msg['Subject'] = 'Test'</code><br><code>msg['From'] = me</code><br><code>msg['To'] = you</code><br><code>server.sendmail(me, [you], msg.as_string())</code><br><code>except Exception as e:</code><br><code># Print any error messages to stdout</code><br><code>print(e)</code><br><code>finally:</code><br><code>server.quit()</code></p><p>That's all for now.</p><p> </p></div></article></main><div class="sidebar"><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><div><a href="https://www.pds-it-solutions.com/authors/p-bryson/" class="authors__title">p Bryson</a> <span class="u-small">Post: 1</span></div></li></ul></section><section class="newsletter box box--gray"><h3 class="box__title">Newsletter</h3><p class="newsletter__description">Sign up to receive email updates and to hear what's going on with us!</p><form>...</form></section></div><footer class="footer"><a class="footer__logo" href="https://www.pds-it-solutions.com/"><img src="https://www.pds-it-solutions.com/media/website/Color-logo-no-background.png" alt="PDS IT Solutions" width="3163" height="1142"></a><nav><ul class="footer__nav"><li class="footer__nav-item"><a href="https://www.pds-it-solutions.com/" target="_self">SysAdmin Library</a></li></ul></nav><div class="footer__copyright"><p>Made by Paul</p></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://www.pds-it-solutions.com/assets/js/scripts.min.js?v=18a65c58aef57c0287e0f0609f3389a9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>